<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
      <!-- Adding bootstrap --> 
  
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    
 <!-- adding font Awesome--> 
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  </head>
  <body onload='preventFormSubmit()'>
  <div class="mt-5 container justify-content-center">
  
  <div class="card" >
    <div class="card-header">
     Nueva lista de comprobante 
    </div>


 <form onSubmit="addNewUser()" class="px-3 py-3">
    
    <div class="form-group">
      <label for="list">Rango Inicio</label>
      <input type="text" class="form-control" id="list" placeholder="Entra asi: 999550">
    </div>
    
    <div class="form-group">
      <label for="list">Rango Final</label>
      <input type="text" class="form-control" id="list2" placeholder="Entra asi: 999559">
    </div>
    
    <button  id="btn-" type="submit" class="btn btn-primary">Registrar comprobantes</button>
</form>


<div class="card-footer">
<a href="<?!=ScriptApp.getService().getUrl() ?>">
<i class="fa fa-arrow-left"></i>
</a>
</div>
 </div>
 
  </div>
<script>  
 function preventFormSubmit() {
        var forms = document.querySelectorAll('form');
        for (var i = 0; i < forms.length; i++) {
          forms[i].addEventListener('submit', function(event) {
            event.preventDefault();
          });
        }
      }
  window.addEventListener('load', preventFormSubmit);
  
  function addNewUser(){
  var list= document.getElementById('list').value;
  var list2= document.getElementById('list2').value;
  var range =""; 
  
  if(list!=""|| list2!=""){
  if(list2>=list){
   range= list +'-'+list2;
   google.script.run
    .withFailureHandler(onError)
    .withSuccessHandler(afterAddedList).setComprobantes(range)
   
   }
  else alert("El inicio debe ser menoro igual que el final de la lista"); }
  else alert("Favor entrar valor por el inicio y el final"); 
  
}
  function onError(e){
  alert(' ERROR: PCSG Problemas con los Servidores de Google intenta mas tarde'+ e); 
  }
  function afterAddedList(e){
   window.open("<?!=ScriptApp.getService().getUrl();?>");
  }
  </script>

  
  
  </body>
  
  
  
</html>
